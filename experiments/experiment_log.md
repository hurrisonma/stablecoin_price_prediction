# 实验日志

## 实验索引

| 实验ID | 日期 | 模型 | Macro F1 | 状态 |
|--------|------|------|----------|------|
| #001 | 2025-12-07 | SimpleLSTM | 0.3332 | ❌ 失败 (标签问题) |
| #002 | 2025-12-07 | SimpleLSTM | 0.4614 | ✅ 基准线 |

---

## 实验 #001 - 方案A初次验证 (失败)

**日期**: 2025-12-07

### 配置
```yaml
模型: SimpleLSTM (1层, hidden=64)
损失函数: Focal Loss
类别权重: [50, 1, 50]
回看窗口: 30分钟
预测周期: 5分钟
```

### 结果
- Accuracy: 99.94%
- Macro F1: 0.3332 (与随机猜测相同)

### 问题分析
标签生成存在三个bug:
1. mid-price精度问题
2. 浮点精度比较失败
3. 往返变化被抵消

**结论**: 实验无效，需修复标签生成

---

## 实验 #002 - 修复标签后的基准实验 ⭐

**日期**: 2025-12-07

### 配置
```yaml
模型: SimpleLSTM (1层, hidden=64)
损失函数: Focal Loss (gamma=2)
类别权重: [15, 1, 15]
回看窗口: 30分钟
预测周期: 5分钟
训练轮数: 11 (早停)
```

### 数据
```
训练集: 下降 3.0% | 不变 93.0% | 上升 3.9%
验证集: 下降 1.2% | 不变 97.7% | 上升 1.1%
测试集: 下降 1.7% | 不变 96.5% | 上升 1.8%
```

### 结果
| 指标 | 值 |
|------|-----|
| Accuracy | 88.10% |
| **Macro F1** | **0.4614** |
| 训练时间 | 0.8 分钟 |

### 各类别指标
| 类别 | Precision | Recall | F1 |
|------|-----------|--------|-----|
| 下降 | 22.54% | 22.22% | 0.2238 |
| 不变 | 98.04% | 89.49% | 0.9357 |
| 上涨 | 13.19% | **76.35%** | 0.2249 |

### 混淆矩阵
```
预测      下降    不变    上升
实际
下降       32     111      1
不变      109    7252    743
上升        1      34    113
```

### 分析

**优点**:
- 上涨召回率较高 (76.35%)，能捕获大部分上涨信号
- Macro F1 (0.46) 显著优于随机 (0.33) 和多数类基线 (0.33)

**缺点**:
- 上涨精确率很低 (13.19%)，假阳性多
- 下跌识别较弱 (P=22%, R=22%)
- 整体准确率低于多数类基线

### 改进方向
1. 提高类别权重或使用更强的Focal Loss
2. 尝试更复杂的模型结构 (LSTM+Attention, Transformer)
3. 增加模型容量 (hidden size, layers)
4. 调整预测周期 (10分钟? 15分钟?)
5. 特征选择 - 只使用最重要的加速度特征

---

## 下一步计划

- [ ] 实验 #003: 增加模型容量 (hidden=128, layers=2)
- [ ] 实验 #004: 使用 LSTM + Attention
- [ ] 实验 #005: 尝试 Transformer
- [ ] 实验 #006: 调整预测周期

---
